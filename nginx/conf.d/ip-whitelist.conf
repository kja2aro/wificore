# IP Whitelist Configuration for Admin Access
# P3 Security Fix - Restrict admin panel access to trusted IPs

# Define trusted IP ranges
geo $admin_allowed {
    default 0;
    
    # Localhost
    127.0.0.1 1;
    ::1 1;
    
    # Docker network
    172.16.0.0/12 1;
    172.70.0.0/16 1;
    
    # VPN network (WireGuard)
    10.0.0.0/8 1;
    
    # Office/Corporate networks (update with your actual IPs)
    # 203.0.113.0/24 1;  # Example office network
    # 198.51.100.0/24 1; # Example backup office
    
    # Cloud provider IPs (if accessing from cloud instances)
    # Add your specific IPs here
    144.91.71.208/32 1;
}

# Map to determine if request should be blocked
map $admin_allowed $admin_access {
    0 "denied";
    1 "allowed";
}
